set -g prefix `
unbind c-b
bind ` send-prefix

# Mouse settings.
set-option -g mouse on
bind -n WheelUpPane   select-pane -t= \; copy-mode -e \; send-keys -M
bind -n WheelDownPane select-pane -t= \;                 send-keys -M
bind -n C-WheelUpPane select-pane -t= \; copy-mode -e \; send-keys -M
bind -t vi-copy    C-WheelUpPane   halfpage-up
bind -t vi-copy    C-WheelDownPane halfpage-down
bind -t emacs-copy C-WheelUpPane   halfpage-up
bind -t emacs-copy C-WheelDownPane halfpage-down

set -g default-terminal "screen-256color"

# set -g status-utf8 on
# set -g status-justify centre
set -g base-index 1
setw -g pane-base-index 1

bind r source-file ~/.tmux.conf \; display "Reloaded!"

bind | split-window -h
bind - split-window -v

bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Smart pane switching with awareness of vim and emacs splits
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim='echo "#{pane_current_command}" | grep -iqE "(^|\/)g?(view|n?vim?x?)(diff)?$|emacs.*"'
bind -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
bind -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
bind -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
bind -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"
bind -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"

# Make 'v' in vi-copy mode start a "on character" selection.
# Note the tmux-yank plugin will handle mapping end-selection
# to 'y', along with copying it to the system clipboard.
bind-key -t vi-copy 'v' begin-selection

# Add binding to clear the screen and scroll buffer.  Similar to cmd-k in
# Terminal/iTerm.
bind -n C-o send-keys " reset && tmux clear-history" "Enter"

# List of plugins
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'seebi/tmux-colors-solarized'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-yank'

# Set color scheme.
set -g @colors-solarized 'light'

# Configure continuum/resurrect
# Note as of macOS 10.12, if I have both @continuum-boot and
# @continuum-restore on, tmux crashes in the middle of the
# child fork-exec.
set -g @continuum-boot 'on'
set -g @continuum-boot-options 'iterm,fullscreen'
# set -g @continuum-restore 'on'

# Initialize TMUX plugin manager (keep this line at the very bottom
# of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# Disable aggressive resize option, which is not compatible
# with iTerm2 tmux integration.
set -g aggressive-resize off

# Below needs to be at the bottom of the .tmux.conf file.
# It enables the continuum auto-start.
run-shell ~/.tmux/plugins/tmux-continuum/continuum.tmux
